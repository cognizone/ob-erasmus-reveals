<div class="d-flex my-close-button">
  <button class="app-dialog-close-button ml-auto" (click)="dialogRef.close()">
    <mat-icon>close</mat-icon>
  </button>
</div>
<ng-container *transloco="let t;read: 'profile'">
  <mat-stepper #stepper linear>
    <!-- Step 1 -->
    <mat-step>
      <section class="d-flex mb-4">
        <img width="32" height="32" [ngSrc]="data.skillId | skillImageUrl" [alt]="t('skill_alt_logo')"/>
        <h1> {{ data.name }} </h1>
      </section>

      <section>
        <h2 class="">{{ t('description') }}</h2>
        <p class="my-skill-description">{{ data.description }}</p>

        <div class="my-skill-information">
          <div>
            <h3 class="my-skill-label">{{ t('used_by') }}</h3>
            <!--<p class="my-target-description">{{ t(target.content) }}</p>-->
          </div>
          <div>
            <h4 class="my-skill-label">{{ t('across') }}</h4>
            <!--<p class="my-target-description">{{ t(target.content) }}</p>-->
          </div>
        </div>
      </section>
      <section class="mt-3 mb-3">
        <ob-erasmus-reveal-countries-map [skillUri]="data.skillId" (selectedCountry)="selectedCountry($event)"></ob-erasmus-reveal-countries-map>
      </section>
      <section class="my-endorsements-section">
        <p>{{ data.endorsementCount }}  {{ t(data.endorsementCount > 1 ? 'endorsements_count' : 'endorsement_count') }}</p>

        <!-- List of feedbacks -->
        <article *ngFor="let feedback of data.feedback">
          <div class="d-flex align-items-center">
            <img width="32" height="32" priority ngSrc="assets/images/icon-svgs/icon-fullcircle-smile_gray.svg"
                 [alt]="t('alt_logo')">
            <h5 class="m-0" *ngIf="feedback.fromLastName || feedback.fromFirstName; else elseTemplate">
              {{ feedback.fromFirstName }} {{ feedback.fromLastName }}
            </h5>
            <ng-template #elseTemplate>
              <h5 class="m-0"> {{ feedback.fromEmail }} </h5>
            </ng-template>
          </div>
          <div class="d-flex justify-content-between my-relationship-detail">
            <p class="my-relationship-type"
               *ngIf="relation?.[feedback.relationshipType]">{{ relation[feedback.relationshipType] }}
            </p>
            <p *ngIf="feedback.fromLastName || feedback.fromFirstName">
              {{ feedback.fromEmail }}
            </p>
          </div>
          <p>{{ feedback.text }}</p>
        </article>
      </section>

      <div class="my-footer">
        <div class="container">
          <div class="row">
            <div class="col-8 mx-auto my-footer-content">
              <button
                  class="app-button"
                  color="primary"
                  routerLink="/feedback-request/create"
                  (click)="dialogRef.close()"
              >
                {{ t('ask_endorsement_skill') }}
              </button>
            </div>
          </div>
        </div>
      </div>
    </mat-step>
    <!-- step 2-->
    <mat-step>
      <button class="app-anchor my-back-button mb-4" color="primary" matStepperPrevious>
        <mat-icon>arrow_forward_ios</mat-icon>
        {{ t('back') }}
      </button>

      <div class="d-flex mb-4">
        <img width="32" height="32" [ngSrc]="data.skillId | skillImageUrl" [alt]="t('skill_alt_logo')"/>
        <h1> {{ data.name }} </h1>
      </div>
      <p class="my-people-count" *ngIf="users">{{ t('people_count', { count: users.length }) }}</p>
      <div class="d-flex mb-3 my-users align-items-center" *ngFor="let user of users">
        <img width="32" height="32" priority ngSrc="assets/images/icon-svgs/icon-fullcircle-smile_gray.svg"
             [alt]="t('alt_logo')">
        <ng-container *ngIf="user.firstName !== ''; else elseTemplate">
          <a class="app-anchor" color="primary" [routerLink]="['../', 'profile', user['@id'] | serializeUri]" (click)="dialogRef.close()"> {{ user.firstName }} {{ user.lastName }} </a>
        </ng-container>
        <ng-template #elseTemplate>
          <a class="app-anchor" color="primary" [routerLink]="['../', 'profile', user['@id'] | serializeUri]" (click)="dialogRef.close()"> {{ user.email }} </a>
        </ng-template>
      </div>
    </mat-step>
    <!-- step 2 ends here -->
  </mat-stepper>
</ng-container>
